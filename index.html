<!DOCTYPE html>
<html lang="th">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Shiba Tracker üê∂üí∞</title>
    <!-- Tailwind CSS CDN -->
    <script src="https://cdn.tailwindcss.com"></script>
    <!-- Google Fonts - Inter -->
    <link href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700&display=swap" rel="stylesheet">
    <style>
        /* Custom styles for Shiba theme */
        body {
            font-family: 'Inter', sans-serif;
            background-color: #fef3c7; /* Light creamy yellow, like Shiba fur */
            color: #4a4a4a; /* Dark gray for text */
            display: flex;
            flex-direction: column;
            min-height: 100vh;
            margin: 0;
            padding: 1rem;
            box-sizing: border-box;
            align-items: center;
        }
        .container {
            max-width: 600px;
            width: 100%;
            background-color: #fff;
            border-radius: 1.5rem; /* More rounded corners */
            box-shadow: 0 10px 25px rgba(0, 0, 0, 0.1);
            padding: 1.5rem;
            margin-bottom: 1rem;
            text-align: center;
        }
        .header {
            color: #e67e22; /* Orange, like Shiba's nose/ears */
            font-weight: 700;
            font-size: 2.25rem; /* Larger title */
            margin-bottom: 1.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.75rem;
        }
        .shiba-emoji {
            font-size: 2.5rem;
            line-height: 1;
        }
        .section-title {
            font-size: 1.5rem;
            font-weight: 600;
            color: #d35400; /* Darker orange */
            margin-bottom: 1rem;
            border-bottom: 2px solid #f0b27a; /* Light orange border */
            padding-bottom: 0.5rem;
        }
        .summary-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.75rem 0;
            border-bottom: 1px dashed #f0b27a;
        }
        .summary-item:last-child {
            border-bottom: none;
        }
        .summary-label {
            font-weight: 500;
            font-size: 1.1rem;
            color: #555;
        }
        .summary-value {
            font-weight: 600;
            font-size: 1.2rem;
        }
        .income-value {
            color: #27ae60; /* Green */
        }
        .expense-value {
            color: #e74c3c; /* Red */
        }
        .balance-value {
            color: #3498db; /* Blue */
            font-size: 1.4rem;
        }
        .transaction-item, .category-item, .budget-item {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding: 0.6rem 0;
            border-bottom: 1px dotted #e0e0e0;
            font-size: 0.95rem;
        }
        .transaction-item:last-child, .category-item:last-child, .budget-item:last-child {
            border-bottom: none;
        }
        .transaction-detail-col, .category-name-col {
            text-align: left;
            flex-grow: 1;
            margin-right: 0.5rem;
        }
        .transaction-amount-col, .budget-amount-col {
            font-weight: 600;
            text-align: right;
        }
        .call-to-action {
            margin-top: 2rem;
            padding: 1.5rem;
            background-color: #ffe0b2; /* Lighter orange */
            border-radius: 1rem;
            box-shadow: 0 5px 15px rgba(0, 0, 0, 0.08);
        }
        .action-button {
            background-color: #f39c12; /* Bright orange */
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            text-decoration: none;
            display: inline-block;
            margin-top: 1rem;
            transition: background-color 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
        }
        .action-button:hover {
            background-color: #e67e22; /* Darker orange on hover */
        }
        .footer-text {
            margin-top: 1.5rem;
            font-size: 0.85rem;
            color: #777;
        }
        .form-group {
            margin-bottom: 1rem;
            text-align: left;
        }
        .form-group label {
            display: block;
            margin-bottom: 0.5rem;
            font-weight: 500;
            color: #555;
        }
        .form-group input[type="number"],
        .form-group input[type="text"],
        .form-group select {
            width: 100%;
            padding: 0.75rem;
            border: 1px solid #ccc;
            border-radius: 0.5rem;
            box-sizing: border-box;
            font-size: 1rem;
        }
        .type-buttons-group {
            display: flex;
            gap: 0.5rem;
            margin-top: 0.5rem;
            margin-bottom: 1rem;
        }
        .type-button {
            flex: 1;
            padding: 0.75rem;
            border-radius: 0.75rem;
            font-weight: 600;
            cursor: pointer;
            transition: background-color 0.3s ease, border-color 0.3s ease;
            border: 2px solid transparent; /* Default transparent border */
        }
        .type-button.income {
            background-color: #2ecc71; /* Green */
            color: white;
        }
        .type-button.expense {
            background-color: #e74c3c; /* Red */
            color: white;
        }
        .type-button.selected {
            border-color: #f39c12; /* Orange border when selected */
            box-shadow: 0 0 0 3px rgba(243, 156, 18, 0.5); /* Orange glow */
        }
        .submit-button {
            background-color: #2ecc71; /* Green for submit */
            color: white;
            padding: 0.8rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
            box-shadow: 0 4px 8px rgba(0, 0, 0, 0.2);
            width: 100%;
            margin-top: 1rem;
        }
        .submit-button:hover {
            background-color: #27ae60; /* Darker green on hover */
        }
        .message-box {
            background-color: #f0f8ff;
            border: 1px solid #a8d9ff;
            color: #31708f;
            padding: 1rem;
            border-radius: 0.5rem;
            margin-bottom: 1rem;
            text-align: left;
            display: none; /* Hidden by default */
        }
        .message-box.success {
            background-color: #d4edda;
            border-color: #c3e6cb;
            color: #155724;
        }
        .message-box.error {
            background-color: #f8d7da;
            border-color: #f5c6cb;
            color: #721c24;
        }
        /* Page specific styles */
        .page {
            display: none; /* All pages hidden by default */
            width: 100%;
        }
        .page.active {
            display: block; /* Active page is shown */
        }
        .top-nav-buttons {
            display: flex;
            justify-content: space-around;
            margin-bottom: 1.5rem;
            background-color: #f0b27a; /* Light orange for nav bar */
            padding: 0.75rem;
            border-radius: 1rem;
            box-shadow: 0 2px 10px rgba(0, 0, 0, 0.1);
            flex-wrap: wrap; /* Allow wrapping for smaller screens */
        }
        .top-nav-button {
            flex: 1 1 auto; /* Allow buttons to grow and shrink */
            min-width: 100px; /* Minimum width for buttons */
            background-color: #e67e22; /* Orange */
            color: white;
            padding: 0.7rem 0.5rem; /* Reduced horizontal padding for more buttons */
            margin: 0.25rem; /* Small margin between buttons */
            border-radius: 0.75rem;
            font-weight: 600;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease, transform 0.1s ease;
            box-shadow: 0 3px 6px rgba(0, 0, 0, 0.2);
            font-size: 0.9rem; /* Smaller font size for more buttons */
        }
        .top-nav-button:hover {
            background-color: #d35400; /* Darker orange on hover */
            transform: translateY(-1px);
        }
        .top-nav-button.active {
            background-color: #d35400; /* Darker orange for active button */
            box-shadow: inset 0 2px 5px rgba(0, 0, 0, 0.2);
        }
        .refresh-button {
            background-color: #3498db; /* Blue for refresh */
            color: white;
            padding: 0.6rem 1rem;
            border-radius: 0.5rem;
            font-weight: 500;
            border: none;
            cursor: pointer;
            transition: background-color 0.3s ease;
            margin-top: 1rem;
        }
        .refresh-button:hover {
            background-color: #2980b9;
        }
    </style>
</head>
<body>
    <div class="container">
        <h1 class="header">
            <span class="shiba-emoji">üê∂</span> Shiba Tracker <span class="shiba-emoji">üí∞</span>
        </h1>

        <div class="message-box" id="messageBox"></div>

        <div class="top-nav-buttons">
            <button class="top-nav-button active" id="btn-add-transaction" onclick="showPage('add-transaction-page')">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£ ‚ú®</button>
            <button class="top-nav-button" id="btn-summary-budget" onclick="showPage('summary-budget-page')">‡∏™‡∏£‡∏∏‡∏õ & ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì üìä</button>
            <button class="top-nav-button" id="btn-manage-categories" onclick="showPage('manage-categories-page')">‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà üè∑Ô∏è</button>
            <button class="top-nav-button" id="btn-set-budget" onclick="showPage('set-budget-page')">‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì üéØ</button>
        </div>

        <!-- Add Transaction Page (Main view as per image) -->
        <div id="add-transaction-page" class="page active">
            <div class="mb-6">
                <h2 class="section-title">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÉ‡∏´‡∏°‡πà ‚ú®</h2>
                <form id="transactionForm" class="text-left">
                    <div class="form-group">
                        <label for="amount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡πÄ‡∏á‡∏¥‡∏ô (‡∏ö‡∏≤‡∏ó):</label>
                        <input type="number" id="amount" step="0.01" min="0.01" placeholder="‡πÄ‡∏ä‡πà‡∏ô 150.75" required class="focus:ring-orange-500 focus:border-orange-500">
                    </div>
                    <div class="form-group">
                        <label for="detail">‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î (‡πÑ‡∏°‡πà‡∏ö‡∏±‡∏á‡∏Ñ‡∏±‡∏ö):</label>
                        <input type="text" id="detail" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏Å‡∏≤‡πÅ‡∏ü" class="focus:ring-orange-500 focus:border-orange-500">
                    </div>
                    <div class="form-group">
                        <label for="category">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà:</label>
                        <select id="category" required class="focus:ring-orange-500 focus:border-orange-500">
                            <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                            <!-- Categories will be loaded dynamically here -->
                        </select>
                    </div>
                    <div class="type-buttons-group">
                        <button type="button" class="type-button income selected" data-type="income">‚úÖ ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</button>
                        <button type="button" class="type-button expense" data-type="expense">‚ùå ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</button>
                    </div>
                    <button type="submit" class="submit-button">‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏Æ‡∏±‡∏ö! ‚ú®</button>
                </form>
            </div>

            <div class="mb-6">
                <h2 class="section-title">‡∏™‡∏£‡∏∏‡∏õ‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠ üìä</h2>
                <div class="summary-item">
                    <span class="summary-label">‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</span>
                    <span class="summary-value balance-value" id="current-balance-add-page">0.00 ‡∏ö‡∏≤‡∏ó</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                    <span class="summary-value income-value" id="current-income-add-page">0.00 ‡∏ö‡∏≤‡∏ó</span>
                </div>
                <div class="summary-item">
                    <span class="summary-label">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                    <span class="summary-value expense-value" id="current-expense-add-page">0.00 ‡∏ö‡∏≤‡∏ó</span>
                </div>
            </div>

            <div class="mb-6">
                <h2 class="section-title">‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î üìú</h2>
                <div id="recent-transactions">
                    <p class="text-gray-500">‡∏Å‡∏≥‡∏•‡∏±‡∏á‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏•‡πà‡∏≤‡∏™‡∏∏‡∏î...</p>
                </div>
            </div>
        </div>

        <!-- Summary & Budget Page -->
        <div id="summary-budget-page" class="page">
            <h2 class="section-title">‡∏™‡∏£‡∏∏‡∏õ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö-‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏£‡∏≤‡∏¢‡πÄ‡∏î‡∏∑‡∏≠‡∏ô üóìÔ∏è</h2>
            <div class="summary-item">
                <span class="summary-label">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                <span class="summary-value income-value" id="monthly-income-summary-page">0.00 ‡∏ö‡∏≤‡∏ó</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢‡∏ó‡∏±‡πâ‡∏á‡∏´‡∏°‡∏î:</span>
                <span class="summary-value expense-value" id="monthly-expense-summary-page">0.00 ‡∏ö‡∏≤‡∏ó</span>
            </div>
            <div class="summary-item">
                <span class="summary-label">‡∏¢‡∏≠‡∏î‡∏Ñ‡∏á‡πÄ‡∏´‡∏•‡∏∑‡∏≠:</span>
                <span class="summary-value balance-value" id="monthly-balance-summary-page">0.00 ‡∏ö‡∏≤‡∏ó</span>
            </div>

            <h2 class="section-title mt-6">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏õ‡∏±‡∏à‡∏à‡∏∏‡∏ö‡∏±‡∏ô üéØ</h2>
            <div id="current-budgets">
                <p class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏•‡∏¢‡∏Æ‡∏±‡∏ö! üòü</p>
            </div>
            <button class="refresh-button" onclick="Telegram.WebApp.close()">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üîÑ</button>
        </div>

        <!-- Manage Categories Page -->
        <div id="manage-categories-page" class="page">
            <h2 class="section-title">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà üè∑Ô∏è</h2>
            <form id="addCategoryForm" class="text-left">
                <div class="form-group">
                    <label for="newCategoryName">‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÉ‡∏´‡∏°‡πà:</label>
                    <input type="text" id="newCategoryName" placeholder="‡πÄ‡∏ä‡πà‡∏ô ‡∏Ñ‡πà‡∏≤‡∏Ç‡∏ô‡∏°, ‡∏£‡∏≤‡∏¢‡πÑ‡∏î‡πâ‡∏û‡∏¥‡πÄ‡∏®‡∏©" required class="focus:ring-orange-500 focus:border-orange-500">
                </div>
                <div class="type-buttons-group">
                    <button type="button" class="type-button income selected" data-type="income" id="newCatTypeIncome">‚úÖ ‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</button>
                    <button type="button" class="type-button expense" data-type="expense" id="newCatTypeExpense">‚ùå ‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</button>
                </div>
                <button type="submit" class="submit-button">‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏Æ‡∏±‡∏ö! ‚ú®</button>
            </form>

            <h2 class="section-title mt-6">‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏Ç‡∏≠‡∏á‡∏Ñ‡∏∏‡∏ì üìã</h2>
            <h3 class="text-lg font-semibold text-gray-700 mb-2">‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö:</h3>
            <div id="income-categories-list" class="text-left">
                <p class="text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</p>
            </div>
            <h3 class="text-lg font-semibold text-gray-700 mt-4 mb-2">‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢:</h3>
            <div id="expense-categories-list" class="text-left">
                <p class="text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</p>
            </div>
            <button class="refresh-button" onclick="Telegram.WebApp.close()">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üîÑ</button>
        </div>

        <!-- Set Budget Page -->
        <div id="set-budget-page" class="page">
            <h2 class="section-title">‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì üéØ</h2>
            <form id="setBudgetForm" class="text-left">
                <div class="form-group">
                    <label for="budgetCategorySelect">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢:</label>
                    <select id="budgetCategorySelect" required class="focus:ring-orange-500 focus:border-orange-500">
                        <option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>
                        <!-- Expense categories will be loaded dynamically here -->
                    </select>
                </div>
                <div class="form-group">
                    <label for="budgetAmount">‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì (‡∏ö‡∏≤‡∏ó):</label>
                    <input type="number" id="budgetAmount" step="0.01" min="0" placeholder="‡πÄ‡∏ä‡πà‡∏ô 5000" required class="focus:ring-orange-500 focus:border-orange-500">
                </div>
                <button type="submit" class="submit-button">‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏Æ‡∏±‡∏ö! ‚ú®</button>
            </form>

            <h2 class="section-title mt-6">‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ üìã</h2>
            <div id="set-budgets-list">
                <p class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏•‡∏¢‡∏Æ‡∏±‡∏ö! üòü</p>
            </div>
            <button class="refresh-button" onclick="Telegram.WebApp.close()">‡∏£‡∏µ‡πÄ‡∏ü‡∏£‡∏ä‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏• üîÑ</button>
        </div>


        <div class="call-to-action">
            <p class="text-base font-medium">‡∏≠‡∏¢‡∏≤‡∏Å‡∏î‡∏π‡∏£‡∏≤‡∏¢‡∏á‡∏≤‡∏ô‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î‡∏Å‡∏ß‡πà‡∏≤‡∏ô‡∏µ‡πâ ‡∏´‡∏£‡∏∑‡∏≠‡∏à‡∏±‡∏î‡∏Å‡∏≤‡∏£‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì/‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÑ‡∏´‡∏°‡∏Æ‡∏±‡∏ö?</p>
            <p class="text-sm text-gray-600 mt-2">‡πÇ‡∏õ‡∏£‡∏î‡∏Å‡∏•‡∏±‡∏ö‡πÑ‡∏õ‡∏ó‡∏µ‡πà‡πÅ‡∏ä‡∏ó‡∏ö‡∏≠‡∏ó‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏¥‡∏ö‡∏∞ ‡πÅ‡∏•‡πâ‡∏ß‡πÉ‡∏ä‡πâ‡∏Ñ‡∏≥‡∏™‡∏±‡πà‡∏á‡∏ï‡πà‡∏≤‡∏á‡πÜ ‡πÑ‡∏î‡πâ‡πÄ‡∏•‡∏¢‡∏Æ‡∏±‡∏ö! üêæ</p>
            <button class="action-button" onclick="Telegram.WebApp.close()">‡∏õ‡∏¥‡∏î Mini App</button>
        </div>
    </div>

    <p class="footer-text">Powered by ‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏¥‡∏ö‡∏∞‡∏ö‡∏≠‡∏ó üê∂</p>

    <script src="https://telegram.org/js/telegram-web-app.js"></script>
    <script>
        // Initialize Telegram WebApp
        Telegram.WebApp.ready();

        const messageBox = document.getElementById('messageBox');
        
        // Elements for Add Transaction Page
        const monthlyIncomeElemAddPage = document.getElementById('current-income-add-page');
        const monthlyExpenseElemAddPage = document.getElementById('current-expense-add-page');
        const monthlyBalanceElemAddPage = document.getElementById('current-balance-add-page');
        const recentTransactionsDiv = document.getElementById('recent-transactions');
        const transactionForm = document.getElementById('transactionForm');
        const amountInput = document.getElementById('amount');
        const detailInput = document.getElementById('detail');
        const categorySelect = document.getElementById('category');
        const typeButtons = document.querySelectorAll('.type-button'); // For transaction form type selection

        // Elements for Summary & Budget Page
        const monthlyIncomeSummaryPage = document.getElementById('monthly-income-summary-page');
        const monthlyExpenseSummaryPage = document.getElementById('monthly-expense-summary-page');
        const monthlyBalanceSummaryPage = document.getElementById('monthly-balance-summary-page');
        const currentBudgetsDiv = document.getElementById('current-budgets');

        // Elements for Manage Categories Page
        const addCategoryForm = document.getElementById('addCategoryForm');
        const newCategoryNameInput = document.getElementById('newCategoryName');
        const newCatTypeIncomeBtn = document.getElementById('newCatTypeIncome');
        const newCatTypeExpenseBtn = document.getElementById('newCatTypeExpense');
        const incomeCategoriesList = document.getElementById('income-categories-list');
        const expenseCategoriesList = document.getElementById('expense-categories-list');
        let selectedNewCategoryType = 'income'; // Default for add category form

        // Elements for Set Budget Page
        const setBudgetForm = document.getElementById('setBudgetForm');
        const budgetCategorySelect = document.getElementById('budgetCategorySelect');
        const budgetAmountInput = document.getElementById('budgetAmount');
        const setBudgetsList = document.getElementById('set-budgets-list');


        // General Page and Navigation Elements
        const pages = document.querySelectorAll('.page');
        const topNavButtons = document.querySelectorAll('.top-nav-button');

        let allCategories = { "‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö": [], "‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢": [] };
        let allBudgets = {};
        let selectedTransactionType = 'income'; // Default selected type for transaction form

        // Function to show/hide pages and update active nav button
        function showPage(pageId) {
            pages.forEach(page => page.classList.remove('active'));
            topNavButtons.forEach(button => button.classList.remove('active'));

            document.getElementById(pageId).classList.add('active');
            document.getElementById(`btn-${pageId.replace('-page', '')}`).classList.add('active');
            
            // Logic to populate dropdowns/lists when navigating to specific pages
            if (pageId === 'add-transaction-page') {
                populateCategories(selectedTransactionType);
            } else if (pageId === 'summary-budget-page') {
                renderCurrentBudgets(allBudgets, allCategories['‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢']);
            } else if (pageId === 'manage-categories-page') {
                renderCategoryLists(allCategories);
                // Reset add category form type buttons
                newCatTypeIncomeBtn.classList.add('selected');
                newCatTypeExpenseBtn.classList.remove('selected');
                selectedNewCategoryType = 'income';
            } else if (pageId === 'set-budget-page') {
                populateBudgetCategorySelect(allCategories['‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢']);
                renderSetBudgetsList(allBudgets, allCategories['‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢']);
            }
            // Adjust WebApp viewport
            Telegram.WebApp.viewportChanged();
        }

        // Function to show messages
        function showMessage(message, type = 'info') {
            messageBox.innerText = message;
            messageBox.className = `message-box ${type}`;
            messageBox.style.display = 'block';
            setTimeout(() => {
                messageBox.style.display = 'none';
            }, 5000); // Hide after 5 seconds
        }

        // Function to render recent transactions
        function renderRecentTransactions(transactions) {
            recentTransactionsDiv.innerHTML = ''; // Clear previous transactions
            if (transactions.length === 0) {
                recentTransactionsDiv.innerHTML = '<p class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏•‡∏¢‡∏Æ‡∏±‡∏ö! üòî</p>';
                return;
            }
            transactions.forEach(t => {
                const itemDiv = document.createElement('div');
                itemDiv.className = 'transaction-item';
                const typeEmoji = t.type === 'income' ? '‚ûï' : '‚ûñ';
                const amountColorClass = t.type === 'income' ? 'text-green-600' : 'text-red-600';
                const formattedAmount = t.amount.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 });
                const detailText = t.detail && t.detail !== '‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏•‡∏∞‡πÄ‡∏≠‡∏µ‡∏¢‡∏î' ? ` (${t.detail})` : '';
                const transactionDate = new Date(t.date);
                const timeString = transactionDate.toLocaleTimeString('th-TH', { hour: '2-digit', minute: '2-digit' });

                itemDiv.innerHTML = `
                    <span class="${amountColorClass} mr-2">${typeEmoji}</span>
                    <span class="transaction-detail-col">${t.category}${detailText}</span>
                    <span class="text-gray-500 text-xs mr-2">${timeString}</span>
                    <span class="transaction-amount-col ${amountColorClass}">${formattedAmount} ‡∏ö‡∏≤‡∏ó</span>
                `;
                recentTransactionsDiv.appendChild(itemDiv);
            });
        }

        // Function to populate categories dropdown for transaction form
        function populateCategories(selectedType) {
            categorySelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>'; // Reset
            const categories = allCategories[selectedType === 'income' ? '‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö' : '‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢'];
            categories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.innerText = cat;
                categorySelect.appendChild(option);
            });
        }

        // Handle type button clicks for transaction form
        typeButtons.forEach(button => {
            button.addEventListener('click', (event) => {
                typeButtons.forEach(btn => btn.classList.remove('selected'));
                event.target.classList.add('selected');
                selectedTransactionType = event.target.dataset.type;
                populateCategories(selectedTransactionType);
            });
        });

        // --- Functions for Summary & Budget Page ---
        function renderCurrentBudgets(budgets, expenseCategories) {
            currentBudgetsDiv.innerHTML = ''; // Clear previous budgets
            if (Object.keys(budgets).length === 0) {
                currentBudgetsDiv.innerHTML = '<p class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏•‡∏¢‡∏Æ‡∏±‡∏ö! üòü</p>';
                return;
            }

            // Get total expense for each category for the current month
            const currentMonth = new Date();
            const startOfMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth(), 1);
            const endOfMonth = new Date(currentMonth.getFullYear(), currentMonth.getMonth() + 1, 0, 23, 59, 59, 999);

            // This part would ideally fetch real-time spending from the bot.
            // For now, we'll simulate or use the data passed from the bot if available.
            // The bot's `open_mini_app` already calculates monthly summary,
            // but not spending per category for budget tracking.
            // A full implementation would require a new bot endpoint to get `expense_by_category`
            // or pass it in the initial `start_param`.
            // For now, we'll just display the budget limits.
            
            // To make it fully functional, we'd need to fetch monthly spending per category.
            // For this example, we'll just show the budget limit.
            // If the `start_param` included `expense_by_category`, we would use it here.
            const dummyExpenseByCategory = {}; // Placeholder

            for (const category of expenseCategories) {
                if (budgets[category]) {
                    const budgetAmount = budgets[category];
                    const spentAmount = dummyExpenseByCategory[category] || 0; // Replace with actual spent if available
                    const remaining = budgetAmount - spentAmount;
                    const statusEmoji = remaining >= 0 ? '‚úÖ' : '‚ùå';
                    const statusColor = remaining >= 0 ? 'text-green-600' : 'text-red-600';

                    const budgetItemDiv = document.createElement('div');
                    budgetItemDiv.className = 'budget-item';
                    budgetItemDiv.innerHTML = `
                        <span class="category-name-col font-medium">${category}:</span>
                        <span class="budget-amount-col">‡∏á‡∏ö: ${budgetAmount.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} ‡∏ö‡∏≤‡∏ó</span>
                        <span class="budget-amount-col ${statusColor}">‡πÉ‡∏ä‡πâ‡πÑ‡∏õ: ${spentAmount.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} ‡∏ö‡∏≤‡∏ó</span>
                        <span class="budget-amount-col ${statusColor}">‡πÄ‡∏´‡∏•‡∏∑‡∏≠: ${remaining.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} ‡∏ö‡∏≤‡∏ó ${statusEmoji}</span>
                    `;
                    currentBudgetsDiv.appendChild(budgetItemDiv);
                }
            }
        }


        // --- Functions for Manage Categories Page ---
        function renderCategoryLists(categories) {
            incomeCategoriesList.innerHTML = '';
            expenseCategoriesList.innerHTML = '';

            if (categories["‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö"].length === 0) {
                incomeCategoriesList.innerHTML = '<p class="text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö</p>';
            } else {
                categories["‡∏£‡∏≤‡∏¢‡∏£‡∏±‡∏ö"].forEach(cat => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'category-item';
                    itemDiv.innerHTML = `<span class="category-name-col">${cat}</span>`;
                    incomeCategoriesList.appendChild(itemDiv);
                });
            }

            if (categories["‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢"].length === 0) {
                expenseCategoriesList.innerHTML = '<p class="text-gray-500">‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢</p>';
            } else {
                categories["‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢"].forEach(cat => {
                    const itemDiv = document.createElement('div');
                    itemDiv.className = 'category-item';
                    itemDiv.innerHTML = `<span class="category-name-col">${cat}</span>`;
                    expenseCategoriesList.appendChild(itemDiv);
                });
            }
        }

        // Handle type button clicks for add category form
        newCatTypeIncomeBtn.addEventListener('click', () => {
            newCatTypeIncomeBtn.classList.add('selected');
            newCatTypeExpenseBtn.classList.remove('selected');
            selectedNewCategoryType = 'income';
        });
        newCatTypeExpenseBtn.addEventListener('click', () => {
            newCatTypeExpenseBtn.classList.add('selected');
            newCatTypeIncomeBtn.classList.remove('selected');
            selectedNewCategoryType = 'expense';
        });

        // Handle Add Category Form Submission
        addCategoryForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const newCategoryName = newCategoryNameInput.value.trim();

            if (!newCategoryName) {
                showMessage("‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏ä‡∏∑‡πà‡∏≠‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Æ‡∏±‡∏ö! üìù", 'error');
                return;
            }

            const dataToSend = {
                action: 'add_category',
                payload: {
                    type: selectedNewCategoryType,
                    category_name: newCategoryName
                }
            };

            try {
                Telegram.WebApp.sendData(JSON.stringify(dataToSend));
                showMessage(`‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà '${newCategoryName}' ‡πÅ‡∏•‡πâ‡∏ß‡∏Æ‡∏±‡∏ö! ‚ú® (‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏õ‡∏¥‡∏î Mini App ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á)`, 'success');
                addCategoryForm.reset();
                // No immediate update, user needs to re-open
            } catch (e) {
                console.error("Error sending add category data to bot:", e);
                showMessage("‡∏Æ‡∏∑‡∏≠‡πÜ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏û‡∏¥‡πà‡∏°‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Æ‡∏±‡∏ö! üò≠", 'error');
            }
        });


        // --- Functions for Set Budget Page ---
        function populateBudgetCategorySelect(expenseCategories) {
            budgetCategorySelect.innerHTML = '<option value="">‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà</option>';
            expenseCategories.forEach(cat => {
                const option = document.createElement('option');
                option.value = cat;
                option.innerText = cat;
                budgetCategorySelect.appendChild(option);
            });
        }

        function renderSetBudgetsList(budgets, expenseCategories) {
            setBudgetsList.innerHTML = '';
            if (Object.keys(budgets).length === 0) {
                setBudgetsList.innerHTML = '<p class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ï‡∏±‡πâ‡∏á‡πÑ‡∏ß‡πâ‡πÄ‡∏•‡∏¢‡∏Æ‡∏±‡∏ö! üòü</p>';
                return;
            }

            for (const category of expenseCategories) {
                if (budgets[category]) {
                    const budgetAmount = budgets[category];
                    const budgetItemDiv = document.createElement('div');
                    budgetItemDiv.className = 'budget-item';
                    budgetItemDiv.innerHTML = `
                        <span class="category-name-col font-medium">${category}:</span>
                        <span class="budget-amount-col">${budgetAmount.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} ‡∏ö‡∏≤‡∏ó</span>
                    `;
                    setBudgetsList.appendChild(budgetItemDiv);
                }
            }
        }

        // Handle Set Budget Form Submission
        setBudgetForm.addEventListener('submit', (event) => {
            event.preventDefault();
            const category = budgetCategorySelect.value;
            const amount = parseFloat(budgetAmountInput.value);

            if (!category) {
                showMessage("‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏•‡∏∑‡∏≠‡∏Å‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡∏î‡πâ‡∏ß‡∏¢‡∏ô‡∏∞‡∏Æ‡∏±‡∏ö! üìù", 'error');
                return;
            }
            if (isNaN(amount) || amount < 0) { // Allow 0 to remove budget
                showMessage("‡πÇ‡∏õ‡∏£‡∏î‡∏£‡∏∞‡∏ö‡∏∏‡∏à‡∏≥‡∏ô‡∏ß‡∏ô‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏ó‡∏µ‡πà‡∏ñ‡∏π‡∏Å‡∏ï‡πâ‡∏≠‡∏á‡∏ô‡∏∞‡∏Æ‡∏±‡∏ö! (‡∏ï‡πâ‡∏≠‡∏á‡πÄ‡∏õ‡πá‡∏ô‡∏ï‡∏±‡∏ß‡πÄ‡∏•‡∏Ç >= 0) ü•∫", 'error');
                return;
            }

            const dataToSend = {
                action: 'set_budget',
                payload: {
                    category: category,
                    amount: amount
                }
            };

            try {
                Telegram.WebApp.sendData(JSON.stringify(dataToSend));
                showMessage(`‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡∏™‡∏≥‡∏´‡∏£‡∏±‡∏ö '${category}' ‡πÅ‡∏•‡πâ‡∏ß‡∏Æ‡∏±‡∏ö! ‚ú® (‡πÇ‡∏õ‡∏£‡∏î‡πÄ‡∏õ‡∏¥‡∏î Mini App ‡πÉ‡∏´‡∏°‡πà‡πÄ‡∏û‡∏∑‡πà‡∏≠‡∏î‡∏π‡∏Å‡∏≤‡∏£‡πÄ‡∏õ‡∏•‡∏µ‡πà‡∏¢‡∏ô‡πÅ‡∏õ‡∏•‡∏á)`, 'success');
                setBudgetForm.reset();
                populateBudgetCategorySelect(allCategories['‡∏£‡∏≤‡∏¢‡∏à‡πà‡∏≤‡∏¢']); // Reset dropdown
                // No immediate update, user needs to re-open
            } catch (e) {
                console.error("Error sending set budget data to bot:", e);
                showMessage("‡∏Æ‡∏∑‡∏≠‡πÜ ‡∏™‡πà‡∏á‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡∏ï‡∏±‡πâ‡∏á‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÑ‡∏°‡πà‡∏™‡∏≥‡πÄ‡∏£‡πá‡∏à‡∏Æ‡∏±‡∏ö! üò≠", 'error');
            }
        });


        // --- Initial Data Loading ---
        if (Telegram.WebApp.initDataUnsafe && Telegram.WebApp.initDataUnsafe.start_param) {
            try {
                const decodedData = decodeURIComponent(Telegram.WebApp.initDataUnsafe.start_param);
                const initialData = JSON.parse(decodedData);
                console.log("Initial Data:", initialData);

                // Update summary on Add Transaction Page
                if (initialData.summary) {
                    monthlyIncomeElemAddPage.innerText = `${initialData.summary.income.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} ‡∏ö‡∏≤‡∏ó`;
                    monthlyExpenseElemAddPage.innerText = `${initialData.summary.expense.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} ‡∏ö‡∏≤‡∏ó`;
                    monthlyBalanceElemAddPage.innerText = `${initialData.summary.balance.toLocaleString('th-TH', { minimumFractionDigits: 2, maximumFractionDigits: 2 })} ‡∏ö‡∏≤‡∏ó`;
                    
                    // Update summary on Summary & Budget Page
                    monthlyIncomeSummaryPage.innerText = monthlyIncomeElemAddPage.innerText;
                    monthlyExpenseSummaryPage.innerText = monthlyExpenseElemAddPage.innerText;
                    monthlyBalanceSummaryPage.innerText = monthlyBalanceElemAddPage.innerText;
                }

                // Render recent transactions
                if (initialData.recent_transactions) {
                    renderRecentTransactions(initialData.recent_transactions);
                }

                // Store and populate categories
                if (initialData.categories) {
                    allCategories = initialData.categories;
                    // Ensure the correct type button is selected visually for transaction form
                    typeButtons.forEach(btn => {
                        if (btn.dataset.type === selectedTransactionType) {
                            btn.classList.add('selected');
                        } else {
                            btn.classList.remove('selected');
                        }
                    });
                    populateCategories(selectedTransactionType);
                }

                // Store and render budgets
                if (initialData.budgets) {
                    allBudgets = initialData.budgets;
                    // Budgets will be rendered when navigating to Summary & Budget or Set Budget page
                    // No need to call render functions here, as showPage will handle it.
                }

            } catch (e) {
                console.error("Error parsing start_param:", e);
                showMessage("‡∏Æ‡∏∑‡∏≠‡πÜ ‡πÄ‡∏Å‡∏¥‡∏î‡∏Ç‡πâ‡∏≠‡∏ú‡∏¥‡∏î‡∏û‡∏•‡∏≤‡∏î‡πÉ‡∏ô‡∏Å‡∏≤‡∏£‡πÇ‡∏´‡∏•‡∏î‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Æ‡∏±‡∏ö! üò≠", 'error');
                // Fallback to empty state if parsing fails
                monthlyIncomeElemAddPage.innerText = '0.00 ‡∏ö‡∏≤‡∏ó';
                monthlyExpenseElemAddPage.innerText = '0.00 ‡∏ö‡∏≤‡∏ó';
                monthlyBalanceElemAddPage.innerText = '0.00 ‡∏ö‡∏≤‡∏ó';
                recentTransactionsDiv.innerHTML = '<p class="text-gray-500">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡πÑ‡∏î‡πâ‡∏Æ‡∏±‡∏ö üòî</p>';
                currentBudgetsDiv.innerHTML = '<p class="text-gray-500">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÑ‡∏î‡πâ‡∏Æ‡∏±‡∏ö üòî</p>';
                incomeCategoriesList.innerHTML = '<p class="text-gray-500">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÑ‡∏î‡πâ‡∏Æ‡∏±‡∏ö üòî</p>';
                expenseCategoriesList.innerHTML = '<p class="text-gray-500">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏´‡∏°‡∏ß‡∏î‡∏´‡∏°‡∏π‡πà‡πÑ‡∏î‡πâ‡∏Æ‡∏±‡∏ö üòî</p>';
                setBudgetsList.innerHTML = '<p class="text-gray-500">‡πÑ‡∏°‡πà‡∏™‡∏≤‡∏°‡∏≤‡∏£‡∏ñ‡πÇ‡∏´‡∏•‡∏î‡∏á‡∏ö‡∏õ‡∏£‡∏∞‡∏°‡∏≤‡∏ì‡πÑ‡∏î‡πâ‡∏Æ‡∏±‡∏ö üòî</p>';
            }
        } else {
            // If no start_param, show empty/default state
            monthlyIncomeElemAddPage.innerText = '0.00 ‡∏ö‡∏≤‡∏ó';
            monthlyExpenseElemAddPage.innerText = '0.00 ‡∏ö‡∏≤‡∏ó';
            monthlyBalanceElemAddPage.innerText = '0.00 ‡∏ö‡∏≤‡∏ó';
            recentTransactionsDiv.innerHTML = '<p class="text-gray-500">‡∏¢‡∏±‡∏á‡πÑ‡∏°‡πà‡∏°‡∏µ‡∏£‡∏≤‡∏¢‡∏Å‡∏≤‡∏£‡∏ö‡∏±‡∏ô‡∏ó‡∏∂‡∏Å‡πÄ‡∏•‡∏¢‡∏Æ‡∏±‡∏ö! üòî</p>';
            showMessage("‡∏ô‡πâ‡∏≠‡∏á‡∏ä‡∏¥‡∏ö‡∏∞‡πÑ‡∏°‡πà‡πÑ‡∏î‡πâ‡∏£‡∏±‡∏ö‡∏Ç‡πâ‡∏≠‡∏°‡∏π‡∏•‡πÄ‡∏£‡∏¥‡πà‡∏°‡∏ï‡πâ‡∏ô‡∏Æ‡∏±‡∏ö! ‡πÇ‡∏õ‡∏£‡∏î‡∏•‡∏≠‡∏á‡πÄ‡∏õ‡∏¥‡∏î Mini App ‡πÉ‡∏´‡∏°‡πà‡∏ô‡∏∞‡∏Æ‡∏±‡∏ö üê∂", 'info');
        }

        // Show add-transaction-page by default when app loads, as per the image
        showPage('add-transaction-page');
    </script>
</body>
</html>
